

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>volue.mesh._base_session &mdash; volue.mesh 1.9.0-dev documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> volue.mesh
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Welcome</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quickstart guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction_to_mesh.html">An introduction to Mesh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hydsim.html">HydSim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authentication.html">Client authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Versions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../versions.html">Versions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SDK Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API documentation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">volue.mesh</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>volue.mesh._base_session</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for volue.mesh._base_session</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">typing</span>
<span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">dateutil</span>
<span class="kn">from</span> <span class="nn">google</span> <span class="kn">import</span> <span class="n">protobuf</span>

<span class="kn">from</span> <span class="nn">volue.mesh.proto.calc.v1alpha</span> <span class="kn">import</span> <span class="n">calc_pb2_grpc</span>
<span class="kn">from</span> <span class="nn">volue.mesh.proto.hydsim.v1alpha</span> <span class="kn">import</span> <span class="n">hydsim_pb2</span><span class="p">,</span> <span class="n">hydsim_pb2_grpc</span>
<span class="kn">from</span> <span class="nn">volue.mesh.proto.model.v1alpha</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">model_pb2</span><span class="p">,</span>
    <span class="n">model_pb2_grpc</span><span class="p">,</span>
    <span class="n">resources_pb2</span> <span class="k">as</span> <span class="n">model_resources_pb2</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">volue.mesh.proto.model_definition.v1alpha</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">model_definition_pb2</span><span class="p">,</span>
    <span class="n">model_definition_pb2_grpc</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">volue.mesh.proto.session.v1alpha</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">session_pb2_grpc</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">volue.mesh.proto.time_series.v1alpha</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">time_series_pb2</span><span class="p">,</span>
    <span class="n">time_series_pb2_grpc</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">volue.mesh.proto.type</span> <span class="kn">import</span> <span class="n">resources_pb2</span>

<span class="kn">from</span> <span class="nn">._attribute</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SIMPLE_TYPE</span><span class="p">,</span>
    <span class="n">SIMPLE_TYPE_OR_COLLECTION</span><span class="p">,</span>
    <span class="n">AttributeBase</span><span class="p">,</span>
    <span class="n">TimeseriesAttribute</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">._common</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AttributesFilter</span><span class="p">,</span>
    <span class="n">LinkRelationVersion</span><span class="p">,</span>
    <span class="n">RatingCurveSegment</span><span class="p">,</span>
    <span class="n">RatingCurveVersion</span><span class="p">,</span>
    <span class="n">XyCurve</span><span class="p">,</span>
    <span class="n">XySet</span><span class="p">,</span>
    <span class="n">_datetime_to_timestamp_pb2</span><span class="p">,</span>
    <span class="n">_object_to_proto_field_mask</span><span class="p">,</span>
    <span class="n">_read_proto_reply</span><span class="p">,</span>
    <span class="n">_to_proto_attribute_field_mask</span><span class="p">,</span>
    <span class="n">_to_proto_attribute_masks</span><span class="p">,</span>
    <span class="n">_to_proto_curve_type</span><span class="p">,</span>
    <span class="n">_to_proto_guid</span><span class="p">,</span>
    <span class="n">_to_proto_utcinterval</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">._mesh_id</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">_to_proto_attribute_mesh_id</span><span class="p">,</span>
    <span class="n">_to_proto_object_mesh_id</span><span class="p">,</span>
    <span class="n">_to_proto_read_timeseries_mesh_id</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">._object</span> <span class="kn">import</span> <span class="n">Object</span>
<span class="kn">from</span> <span class="nn">._timeseries</span> <span class="kn">import</span> <span class="n">Timeseries</span>
<span class="kn">from</span> <span class="nn">._timeseries_resource</span> <span class="kn">import</span> <span class="n">TimeseriesResource</span>
<span class="kn">from</span> <span class="nn">.calc.forecast</span> <span class="kn">import</span> <span class="n">ForecastFunctions</span>
<span class="kn">from</span> <span class="nn">.calc.history</span> <span class="kn">import</span> <span class="n">HistoryFunctions</span>
<span class="kn">from</span> <span class="nn">.calc.statistical</span> <span class="kn">import</span> <span class="n">StatisticalFunctions</span>
<span class="kn">from</span> <span class="nn">.calc.transform</span> <span class="kn">import</span> <span class="n">TransformFunctions</span>

<span class="n">EXTEND_SESSION_LIFETIME_INTERVAL_IN_SECS</span> <span class="o">=</span> <span class="mi">150</span>


<span class="k">class</span> <span class="nc">Session</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">WorkerThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">session</span><span class="p">:</span> <span class="n">Session</span><span class="p">,</span>
            <span class="n">event_loop</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
            <span class="c1"># no resources are acquired, no need to do explicit clean-up</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="p">:</span> <span class="n">Session</span> <span class="o">=</span> <span class="n">session</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">event_loop</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">asyncio</span><span class="o">.</span><span class="n">AbstractEventLoop</span><span class="p">]</span> <span class="o">=</span> <span class="n">event_loop</span>

        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_loop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">set_event_loop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">event_loop</span><span class="p">)</span>

            <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">stop_worker_thread</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span>
                <span class="n">EXTEND_SESSION_LIFETIME_INTERVAL_IN_SECS</span>
            <span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_loop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">extend_lifetime_coroutine</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Coroutine</span><span class="p">[</span>
                            <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="kc">None</span>
                        <span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">_extend_lifetime</span><span class="p">()</span>
                        <span class="n">asyncio</span><span class="o">.</span><span class="n">run_coroutine_threadsafe</span><span class="p">(</span>
                            <span class="n">extend_lifetime_coroutine</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">event_loop</span>
                        <span class="p">)</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">_extend_lifetime</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="c1"># In case of an exception just add more descriptive</span>
                    <span class="c1"># message and exit the worker thread.</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;session </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">session_id</span><span class="si">}</span><span class="s2"> worker thread exception&quot;</span>
                    <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a session to a Mesh server.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_extend_lifetime</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Request to extend session lifetime on the Mesh server.</span>
<span class="sd">        This is used internally by the Mesh Python SDK and the user does not</span>
<span class="sd">        need to call it explicitly.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">calc_service</span><span class="p">:</span> <span class="n">calc_pb2_grpc</span><span class="o">.</span><span class="n">CalculationServiceStub</span><span class="p">,</span>
        <span class="n">hydsim_service</span><span class="p">:</span> <span class="n">hydsim_pb2_grpc</span><span class="o">.</span><span class="n">HydsimServiceStub</span><span class="p">,</span>
        <span class="n">model_service</span><span class="p">:</span> <span class="n">model_pb2_grpc</span><span class="o">.</span><span class="n">ModelServiceStub</span><span class="p">,</span>
        <span class="n">model_definition_service</span><span class="p">:</span> <span class="n">model_definition_pb2_grpc</span><span class="o">.</span><span class="n">ModelDefinitionServiceStub</span><span class="p">,</span>
        <span class="n">session_service</span><span class="p">:</span> <span class="n">session_pb2_grpc</span><span class="o">.</span><span class="n">SessionServiceStub</span><span class="p">,</span>
        <span class="n">time_series_service</span><span class="p">:</span> <span class="n">time_series_pb2_grpc</span><span class="o">.</span><span class="n">TimeseriesServiceStub</span><span class="p">,</span>
        <span class="n">session_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a session object for working with the Mesh server.</span>

<span class="sd">        Args:</span>
<span class="sd">            calc_service: gRPC generated Mesh calculation service.</span>
<span class="sd">            hydsim_service: gRPC generated Mesh HydSim service.</span>
<span class="sd">            model_service: gRPC generated Mesh model service.</span>
<span class="sd">            model_definition_service: gRPC generated Mesh model definition service.</span>
<span class="sd">            session_service: gRPC generated Mesh session service.</span>
<span class="sd">            time_series_service: gRPC generated Mesh time series service.</span>
<span class="sd">            session_id: ID of the session you are (or want to be) connected to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">]</span> <span class="o">=</span> <span class="n">session_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calc_service</span><span class="p">:</span> <span class="n">calc_pb2_grpc</span><span class="o">.</span><span class="n">CalculationServiceStub</span> <span class="o">=</span> <span class="n">calc_service</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hydsim_service</span><span class="p">:</span> <span class="n">hydsim_pb2_grpc</span><span class="o">.</span><span class="n">HydsimServiceStub</span> <span class="o">=</span> <span class="n">hydsim_service</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_service</span><span class="p">:</span> <span class="n">model_pb2_grpc</span><span class="o">.</span><span class="n">ModelServiceStub</span> <span class="o">=</span> <span class="n">model_service</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_definition_service</span><span class="p">:</span> <span class="p">(</span>
            <span class="n">model_definition_pb2_grpc</span><span class="o">.</span><span class="n">ModelDefinitionServiceStub</span>
        <span class="p">)</span> <span class="o">=</span> <span class="n">model_definition_service</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session_service</span><span class="p">:</span> <span class="n">session_pb2_grpc</span><span class="o">.</span><span class="n">SessionServiceStub</span> <span class="o">=</span> <span class="n">session_service</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_series_service</span><span class="p">:</span> <span class="n">time_series_pb2_grpc</span><span class="o">.</span><span class="n">TimeseriesServiceStub</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">time_series_service</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stop_worker_thread</span><span class="p">:</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker_thread</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Session</span><span class="o">.</span><span class="n">WorkerThread</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Request to open a session on the Mesh server.</span>
<span class="sd">        An opened session must be closed using the same `Session` object.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Request to close a session on the Mesh server.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed</span>

<span class="sd">        Note:</span>
<span class="sd">            This method does not wait for the Mesh server to finish closing</span>
<span class="sd">            the session on the Mesh server.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">rollback</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Discard changes in the :doc:`Mesh session &lt;mesh_session&gt;`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">commit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Commit changes made in the :doc:`Mesh session &lt;mesh_session&gt;` to the shared storage.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">read_timeseries_points</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timeseries</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads time series points for</span>
<span class="sd">        the specified time series in the given interval.</span>
<span class="sd">        For information about `datetime` arguments and time zones refer to</span>
<span class="sd">        :ref:`mesh_client:Date times and time zones`.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh attribute, virtual or physical time series. It could</span>
<span class="sd">                be a time series key, Universal Unique Identifier or a path in</span>
<span class="sd">                the :ref:`Mesh model &lt;mesh_model&gt;`.</span>
<span class="sd">            start_time: the start date and time of the time series interval</span>
<span class="sd">            end_time: the end date and time of the time series interval</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed</span>
<span class="sd">            RuntimeError: Error message raised if the input is not valid</span>
<span class="sd">            TypeError: Error message raised if the returned result from the request is not as expected</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">write_timeseries_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeseries</span><span class="p">:</span> <span class="n">Timeseries</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes time series points for the specified time series in the given interval.</span>
<span class="sd">        Resolution of the time series does not need to be set when writing time series.</span>

<span class="sd">        Args:</span>
<span class="sd">            timeseries: The modified time series.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">list_models</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Object</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        List all :ref:`Mesh models &lt;mesh_model&gt;`.</span>
<span class="sd">        Model is a root object that does not have an owner.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_object</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Object</span><span class="p">],</span>
        <span class="n">full_attribute_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">attributes_filter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AttributesFilter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Request information associated with a Mesh object from the Mesh model.</span>
<span class="sd">        Specify either `object_id` or `object_path` to a Mesh object.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh object to be read. It could be a Universal Unique Identifier</span>
<span class="sd">                or a path in the :ref:`Mesh model &lt;mesh_model&gt;`. See:</span>
<span class="sd">                :ref:`objects and attributes paths &lt;mesh_object_attribute_path&gt;`.</span>
<span class="sd">            full_attribute_info: If set then all information (e.g. description, value type, etc.)</span>
<span class="sd">                of attributes owned by the object will be returned, otherwise only name,</span>
<span class="sd">                path, ID and value(s).</span>
<span class="sd">            attributes_filter: Filtering criteria for what attributes owned by</span>
<span class="sd">                object should be returned. By default all attributes are returned.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">search_for_objects</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Object</span><span class="p">],</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">full_attribute_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">attributes_filter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AttributesFilter</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Object</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use the :doc:`Mesh search language &lt;mesh_search&gt;` to find Mesh objects</span>
<span class="sd">        in the Mesh model.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Start searching at the target object. It could be a Universal Unique Identifier</span>
<span class="sd">                or a path in the :ref:`Mesh model &lt;mesh_model&gt;`. See:</span>
<span class="sd">                :ref:`objects and attributes paths &lt;mesh_object_attribute_path&gt;`.</span>
<span class="sd">            query: A search formulated using the :doc:`Mesh search language &lt;mesh_search&gt;`.</span>
<span class="sd">            full_attribute_info: If set then all information (e.g. description, value type, etc.)</span>
<span class="sd">                of attributes owned by the object(s) will be returned, otherwise only name,</span>
<span class="sd">                path, ID and value(s).</span>
<span class="sd">            attributes_filter: Filtering criteria for what attributes owned by</span>
<span class="sd">                object(s) should be returned. By default all attributes are returned.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">create_object</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create new Mesh object in the Mesh model.</span>
<span class="sd">        Owner of the new object must be a one-to-one or one-to-many ownership</span>
<span class="sd">        relation attribute. E.g.: for `SomePowerPlant1` object with path:</span>
<span class="sd">        - Model/SimpleThermalTestModel/ThermalComponent.ThermalPowerToPlantRef/SomePowerPlant1</span>

<span class="sd">        Owner will be the `ThermalPowerToPlantRef` attribute.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Owner of the new object to be created. It must be a</span>
<span class="sd">                one-to-one (object value type = &quot;ElementAttributeDefinition&quot;)</span>
<span class="sd">                or one-to-many (object value type = &quot;ElementCollectionAttributeDefinition&quot;)</span>
<span class="sd">                ownership relation attribute.</span>
<span class="sd">                It could be a Universal Unique Identifier or a path in the</span>
<span class="sd">                :ref:`Mesh model &lt;mesh_model&gt;`.</span>
<span class="sd">            name: Name for the new object to create.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created object with all attributes (no mask applied) and basic</span>
<span class="sd">            information: name, path, ID and value(s).</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">update_object</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Object</span><span class="p">],</span>
        <span class="n">new_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">new_owner_attribute</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update an existing Mesh object in the Mesh model.</span>
<span class="sd">        New owner of the object must be a one-to-one or one-to-many ownership</span>
<span class="sd">        relation attribute. E.g.: for `SomePowerPlant1` object with path:</span>
<span class="sd">        - Model/SimpleThermalTestModel/ThermalComponent.ThermalPowerToPlantRef/SomePowerPlant1</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh object to be updated. It could be a Universal Unique Identifier</span>
<span class="sd">                or a path in the :ref:`Mesh model &lt;mesh_model&gt;`. See:</span>
<span class="sd">                :ref:`objects and attributes paths &lt;mesh_object_attribute_path&gt;`</span>
<span class="sd">            new_name: New name for the object.</span>
<span class="sd">            new_owner_attribute: New owner of the object. It must be a</span>
<span class="sd">                one-to-one (object value type = &quot;ElementAttributeDefinition&quot;)</span>
<span class="sd">                or one-to-many (object value type = &quot;ElementCollectionAttributeDefinition&quot;)</span>
<span class="sd">                ownership relation attribute.</span>
<span class="sd">                It could be a Universal Unique Identifier or a path in the</span>
<span class="sd">                :ref:`Mesh model &lt;mesh_model&gt;`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">delete_object</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Object</span><span class="p">],</span> <span class="n">recursive_delete</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delete an existing Mesh object in the Mesh model.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh object to be deleted. It could be a Universal Unique Identifier</span>
<span class="sd">                or a path in the :ref:`Mesh model &lt;mesh_model&gt;`. See:</span>
<span class="sd">                :ref:`objects and attributes paths &lt;mesh_object_attribute_path&gt;`</span>
<span class="sd">            recursive_delete: If set then all child objects</span>
<span class="sd">                (owned by the object to be deleted) in the model will also be deleted.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_attribute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">full_attribute_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AttributeBase</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Request information associated with a Mesh :ref:`attribute &lt;mesh_attribute&gt;`</span>
<span class="sd">        from the Mesh model.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh attribute to be read. It could be a Universal Unique Identifier</span>
<span class="sd">                or a path in the :ref:`Mesh model &lt;mesh_model&gt;`. See:</span>
<span class="sd">                :ref:`objects and attributes paths &lt;mesh_object_attribute_path&gt;`.</span>
<span class="sd">            full_attribute_info: If set then all information (e.g. description, value type, etc.)</span>
<span class="sd">                of attribute will be returned, otherwise only name, path, ID and value(s).</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_timeseries_attribute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">full_attribute_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeseriesAttribute</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Request information associated with a Mesh :ref:`time series attribute &lt;mesh_attribute&gt;` from the Mesh model.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh time series attribute to be read. It could be a Universal Unique</span>
<span class="sd">                Identifier or a path in the :ref:`Mesh model &lt;mesh_model&gt;`. See:</span>
<span class="sd">                :ref:`objects and attributes paths &lt;mesh_object_attribute_path&gt;`.</span>
<span class="sd">            full_attribute_info: If set then all information (e.g. description, value type, etc.)</span>
<span class="sd">                of attribute will be returned, otherwise only name, path, ID and value(s).</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">            ValueError: Raised if given attribute ID or path points to an attribute of</span>
<span class="sd">                different type than `TimeseriesAttribute`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">search_for_attributes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Object</span><span class="p">],</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">full_attribute_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">AttributeBase</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use the :doc:`Mesh search language &lt;mesh_search&gt;` to find Mesh</span>
<span class="sd">        :ref:`attributes &lt;mesh_attribute&gt;` in the Mesh model.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Start searching at the target object. It could be a Universal Unique Identifier</span>
<span class="sd">                or a path in the :ref:`Mesh model &lt;mesh_model&gt;`. See:</span>
<span class="sd">                :ref:`objects and attributes paths &lt;mesh_object_attribute_path&gt;`.</span>
<span class="sd">            query: A search formulated using the :doc:`Mesh search language &lt;mesh_search&gt;`.</span>
<span class="sd">            full_attribute_info: If set then all information (e.g. description, value type, etc.)</span>
<span class="sd">                of attributes owned by the object(s) will be returned, otherwise only name,</span>
<span class="sd">                path, ID and value(s).</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">search_for_timeseries_attributes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Object</span><span class="p">],</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">full_attribute_info</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">TimeseriesAttribute</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use the :doc:`Mesh search language &lt;mesh_search&gt;` to find Mesh</span>
<span class="sd">        :ref:`time series attributes &lt;mesh_attribute&gt;` in the Mesh model.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Start searching at the target object. It could be a Universal Unique Identifier</span>
<span class="sd">                or a path in the :ref:`Mesh model &lt;mesh_model&gt;`. See:</span>
<span class="sd">                :ref:`objects and attributes paths &lt;mesh_object_attribute_path&gt;`.</span>
<span class="sd">            query: A search formulated using the :doc:`Mesh search language &lt;mesh_search&gt;`.</span>
<span class="sd">            full_attribute_info: If set then all information (e.g. description, value type, etc.)</span>
<span class="sd">                of attributes owned by the object(s) will be returned, otherwise only name,</span>
<span class="sd">                path, ID and value(s).</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">update_simple_attribute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">value</span><span class="p">:</span> <span class="n">SIMPLE_TYPE_OR_COLLECTION</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update an existing Mesh simple attribute&#39;s value in the Mesh model.</span>
<span class="sd">        Simple attribute is a singular type or collection of the following types:</span>
<span class="sd">        - double (float in Python)</span>
<span class="sd">        - integer (int in Python)</span>
<span class="sd">        - boolean (bool in Python)</span>
<span class="sd">        - string (str in Python)</span>
<span class="sd">        - UTC time (datetime in Python)</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh attribute to be updated. It could be a Universal Unique Identifier</span>
<span class="sd">                or a path in the :ref:`Mesh model &lt;mesh_model&gt;`. See:</span>
<span class="sd">                :ref:`objects and attributes paths &lt;mesh_object_attribute_path&gt;`.</span>
<span class="sd">            value: New simple attribute value. It can be one of following simple types:</span>
<span class="sd">                bool, float, int, str, datetime or a list of simple types.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">update_timeseries_attribute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">new_local_expression</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">new_timeseries_resource_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update meta data of an existing Mesh time series attribute&#39;s in the Mesh model.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh time series attribute to be updated. It could be a Universal Unique</span>
<span class="sd">                Identifier or a path in the :ref:`Mesh model &lt;mesh_model&gt;`. See:</span>
<span class="sd">                :ref:`objects and attributes paths &lt;mesh_object_attribute_path&gt;`.</span>
<span class="sd">            new_local_expression: New local expression.</span>
<span class="sd">            new_timeseries_resource_key: Time series key of a new time series resource</span>
<span class="sd">                (physical or virtual) to connect to the time series attribute. To disconnect</span>
<span class="sd">                time series attribute from already connected time series resource set this</span>
<span class="sd">                argument to 0.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">update_link_relation_attribute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">new_target_object_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">],</span>
        <span class="n">append</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update an existing Mesh link relation (non-versioned) attribute in the Mesh model.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh one-to-one or one-to-many link relation (non-versioned) attribute</span>
<span class="sd">                to be updated. It could be a Universal Unique Identifier or a path in the</span>
<span class="sd">                :ref:`Mesh model &lt;mesh_model&gt;`. See: :ref:`objects and attributes paths</span>
<span class="sd">                &lt;mesh_object_attribute_path&gt;`.</span>
<span class="sd">            new_target_object_ids: List of objects the link relation will point to. For</span>
<span class="sd">                one-to-one link relation this must contain zero or one `new_target_object_ids`.</span>
<span class="sd">                If there is no `new_target_object_ids` provided then currently existing target</span>
<span class="sd">                object will be removed. If updating a one-to-many link relation attribute</span>
<span class="sd">                this may contain zero, one or more `new_target_object_ids`s. If there is no</span>
<span class="sd">                `new_target_object_ids` provided and `append` is set to `False` then all</span>
<span class="sd">                currently existing target objects will be removed.</span>
<span class="sd">            append: If set to `True` for a one-to-many link relation attribute this will</span>
<span class="sd">                append `target_object_ids` to already existing ones. If set to `False` then</span>
<span class="sd">                all currently existing target objects will be replaced by `target_object_ids`.</span>
<span class="sd">                For one-to-one link relation attribute this must set to `False`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :doc:`mesh_relations`</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">update_versioned_one_to_one_link_relation_attribute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">new_versions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">LinkRelationVersion</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update an existing Mesh versioned one-to-one link relation attribute in</span>
<span class="sd">        the Mesh model.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh one-to-one versioned link relation attribute to be updated.</span>
<span class="sd">                It could be a Universal Unique Identifier or a path in the</span>
<span class="sd">                :ref:`Mesh model &lt;mesh_model&gt;`. See: :ref:`objects and attributes paths</span>
<span class="sd">                &lt;mesh_object_attribute_path&gt;`.</span>
<span class="sd">            start_time: the (inclusive) start of the edit interval.</span>
<span class="sd">            end_time: the (exclusive) end of the edit interval.</span>
<span class="sd">            new_versions: the list of link relation versions to insert.</span>
<span class="sd">                All versions must be within `[start_time, end_time)` interval.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :doc:`mesh_relations`</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_timeseries_resource_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeseries_key</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TimeseriesResource</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Request information (like curve type or resolution) associated with</span>
<span class="sd">        a physical or virtual time series.</span>

<span class="sd">        Args:</span>
<span class="sd">            timeseries_key: integer that only applies to a specific physical or</span>
<span class="sd">                virtual time series.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">update_timeseries_resource_info</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">timeseries_key</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">new_curve_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Timeseries</span><span class="o">.</span><span class="n">Curve</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">new_unit_of_measurement</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update information associated with a physical or virtual time series.</span>

<span class="sd">        Args:</span>
<span class="sd">            timeseries_key: integer that only applies to a specific physical or</span>
<span class="sd">                virtual time series.</span>
<span class="sd">            new_curve_type: set new  curve type.</span>
<span class="sd">            new_unit_of_measurement: set new unit of measurement.</span>

<span class="sd">        Note:</span>
<span class="sd">            Specify which ever of the new_* fields you want to update.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">forecast_functions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ForecastFunctions</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Access to :ref:`mesh_functions:Forecast` functions.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh object, attribute, virtual or physical time series the</span>
<span class="sd">                calculation expression will be evaluated relative to.</span>
<span class="sd">                It could be a time series key, Universal Unique Identifier or</span>
<span class="sd">                a path in the :ref:`Mesh model &lt;mesh_model&gt;`.</span>
<span class="sd">            start_time: the start date and time of the time series interval</span>
<span class="sd">            end_time: the end date and time of the time series interval</span>

<span class="sd">        Returns:</span>
<span class="sd">            Object containing all forecast functions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">history_functions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HistoryFunctions</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Access to :ref:`mesh_functions:History` functions.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh object, attribute, virtual or physical time series the</span>
<span class="sd">                calculation expression will be evaluated relative to.</span>
<span class="sd">                It could be a time series key, Universal Unique Identifier or</span>
<span class="sd">                a path in the :ref:`Mesh model &lt;mesh_model&gt;`.</span>
<span class="sd">            start_time: the start date and time of the time series interval</span>
<span class="sd">            end_time: the end date and time of the time series interval</span>

<span class="sd">        Returns:</span>
<span class="sd">           Object containing all history functions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">statistical_functions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StatisticalFunctions</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Access to :ref:`mesh_functions:Statistical` functions.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh object, attribute, virtual or physical time series the</span>
<span class="sd">                calculation expression will be evaluated relative to.</span>
<span class="sd">                It could be a time series key, Universal Unique Identifier or</span>
<span class="sd">                a path in the :ref:`Mesh model &lt;mesh_model&gt;`.</span>
<span class="sd">            start_time: the start date and time of the time series interval</span>
<span class="sd">            end_time: the end date and time of the time series interval</span>

<span class="sd">        Returns:</span>
<span class="sd">            Object containing all statistical functions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">transform_functions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">TransformFunctions</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Access to :ref:`mesh_functions:Transform` functions.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: Mesh object, attribute, virtual or physical time series the</span>
<span class="sd">                calculation expression will be evaluated relative to.</span>
<span class="sd">                It could be a time series key, Universal Unique Identifier or</span>
<span class="sd">                a path in the :ref:`Mesh model &lt;mesh_model&gt;`.</span>
<span class="sd">            start_time: the start date and time of the time series interval</span>
<span class="sd">            end_time: the end date and time of the time series interval</span>

<span class="sd">        Returns:</span>
<span class="sd">            Object containing all transformation functions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_xy_sets</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">],</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">],</span>
        <span class="n">versions_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">XySet</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get zero or more XY-sets from an XY-set attribute on the server.</span>

<span class="sd">        An XY-set attribute is either versioned, with a kind</span>
<span class="sd">        :code:`XYZSeriesAttribute`, or unversioned, with a kind</span>
<span class="sd">        :code:`XYSetAttribute`.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: the GUID or the path of an XY-set attribute.</span>

<span class="sd">            start_time: the (inclusive) start of the interval to retrieve XY</span>
<span class="sd">                sets in for versioned XY-set attributes. Must be :code:`None`</span>
<span class="sd">                for unversioned attributes.</span>

<span class="sd">            end_time: the (exclusive) end of the interval to retrieve XY sets</span>
<span class="sd">                in for versioned XY-set attributes. Must be :code:`None` for</span>
<span class="sd">                unversioned attributes.</span>

<span class="sd">            versions_only: don&#39;t retrieve XY-set curves, only :code:`valid_from_time`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of :class:`XySet`. The list always contains one element for</span>
<span class="sd">            unversioned attributes, and zero or more elements for versioned</span>
<span class="sd">            attributes.</span>

<span class="sd">            For versioned attributes the method will return all XY sets that</span>
<span class="sd">            are valid in :code:`[start_time, end_time)`. This may include the</span>
<span class="sd">            last XY set that started its validity period before the interval.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed</span>
<span class="sd">            TypeError: on invalid arguments (see above).</span>

<span class="sd">        See Also:</span>
<span class="sd">            :doc:`mesh_xy_sets`</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">update_xy_sets</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">],</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">],</span>
        <span class="n">new_xy_sets</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">XySet</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Replace XY sets on an XY-set attribute on the server.</span>

<span class="sd">        An XY-set attribute is either versioned, with a kind</span>
<span class="sd">        :code:`XYZSeriesAttribute`, or unversioned, with a kind</span>
<span class="sd">        :code:`XYSetAttribute`.</span>

<span class="sd">        When applied to an unversioned attribute the update_xy_sets operation</span>
<span class="sd">        removes the existing XY-set, and replaces it with the contents of</span>
<span class="sd">        :code:`xy_sets`, which must contain zero or one XY-set.</span>

<span class="sd">        When applied to a versioned attribute the operation deletes all</span>
<span class="sd">        versions in the interval :code:`[start_time, end_time)`, and inserts</span>
<span class="sd">        the new versions in :code:`xy_sets`.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: the GUID or the path of an XY-set attribute.</span>
<span class="sd">            start_time: the (inclusive) start of the edit interval. Must be</span>
<span class="sd">                None for unversioned XY-set attributes.</span>
<span class="sd">            end_time: the (exclusive) end of the edit interval. Must be</span>
<span class="sd">                None for unversioned XY-set attributes.</span>
<span class="sd">            new_xy_sets: the list of XY-sets to insert. Must contain zero or</span>
<span class="sd">                one element for unversioned attributes. All elements must be</span>
<span class="sd">                within :code:`[start_time, end_time)` for versioned attributes.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed</span>
<span class="sd">            TypeError: on invalid arguments (see above).</span>

<span class="sd">        See Also:</span>
<span class="sd">            :doc:`mesh_xy_sets`</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_rating_curve_versions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">versions_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">RatingCurveVersion</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get rating curve versions from an rating curve attribute on the server.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: the ID or the path of an rating curve attribute.</span>
<span class="sd">            start_time: the (inclusive) start of the interval to retrieve</span>
<span class="sd">                rating curve versions.</span>
<span class="sd">            end_time: the (exclusive) end of the interval to retrieve</span>
<span class="sd">                rating curve versions.</span>
<span class="sd">            versions_only: retrieve only `valid_from_time` timestamps for each</span>
<span class="sd">                version, no other data like segments will be retrieved.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of :class:`RatingCurveVersion`.</span>

<span class="sd">            The method will return all rating curve versions that are valid in</span>
<span class="sd">            `[start_time, end_time)` interval. This may include the last rating</span>
<span class="sd">            curve version that started its validity period before the interval.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :doc:`mesh_rating_curve`</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">update_rating_curve_versions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">new_versions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RatingCurveVersion</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Replace rating curve versions on an rating curve attribute on the server.</span>

<span class="sd">        The update operation deletes all versions in the</span>
<span class="sd">        `[start_time, end_time)` interval, and inserts the new versions.</span>

<span class="sd">        Args:</span>
<span class="sd">            target: the ID or the path of an rating curve attribute.</span>
<span class="sd">            start_time: the (inclusive) start of the edit interval.</span>
<span class="sd">            end_time: the (exclusive) end of the edit interval.</span>
<span class="sd">            new_versions: the list of rating curve versions to insert.</span>
<span class="sd">                All versions must be within `[start_time, end_time)` interval</span>
<span class="sd">                and sorted by `valid_from_time`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            grpc.RpcError: Error message raised if the gRPC request could not be completed.</span>

<span class="sd">        See Also:</span>
<span class="sd">            :doc:`mesh_rating_curve`</span>
<span class="sd">        &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Session.run_simulation"><a class="viewcode-back" href="../../../hydsim.html#volue.mesh._base_session.Session.run_simulation">[docs]</a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">run_simulation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">case</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">resolution</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">scenario</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">return_datasets</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run a hydro simulation using HydSim on the Mesh server.</span>

<span class="sd">        This function is experimental and subject to larger changes.</span>

<span class="sd">        Args:</span>
<span class="sd">            model: The name of the Mesh model in which the simulation case exists.</span>
<span class="sd">            case: The names of the case group and simulation case in the form</span>
<span class="sd">                &#39;CaseGroup/CaseName&#39;.</span>
<span class="sd">            start_time: The (inclusive) start of the simulation interval.</span>
<span class="sd">            end_time: The (exclusive) end of the simulation interval.</span>
<span class="sd">            resolution: The resolution of the simulation. The default resolution</span>
<span class="sd">                of the simulation case is used if this is left as `None`.</span>
<span class="sd">                Officially supported resolutions are 5, 10, 15, and 60 minutes.</span>
<span class="sd">            scenario: The scenario(s) to run. All scenarios are run if left as</span>
<span class="sd">                `None`, no scenarios are run if set as -1, and a specific</span>
<span class="sd">                numbered scenario is run if set as the number of that scenario.</span>
<span class="sd">            return_datasets: Generate and return HydSim datasets that can be used</span>
<span class="sd">                by Volue to diagnose issues with hydro simulations. For performance</span>
<span class="sd">                reasons this should be false when not trying to diagnose an issue.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An iterator of `None`. In future versions this iterator will yield</span>
<span class="sd">            log messages, datasets, and potentially more. The simulation is</span>
<span class="sd">            done when the iterator is exhausted.</span>

<span class="sd">            Exhausting the iterator without an exception does not guarantee</span>
<span class="sd">            that the simulation completed successfully. To determine that</span>
<span class="sd">            you must analyze the simulation&#39;s result time series and the</span>
<span class="sd">            log messages from the server.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError</span>
<span class="sd">            grpc.RpcError</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="Session.run_inflow_calculation"><a class="viewcode-back" href="../../../hydsim.html#volue.mesh._base_session.Session.run_inflow_calculation">[docs]</a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">run_inflow_calculation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">area</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">water_course</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">resolution</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">return_datasets</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run an inflow calculation using HydSim on the Mesh server.</span>

<span class="sd">        Args:</span>
<span class="sd">            model: The name of the Mesh model in which the inflow calculation</span>
<span class="sd">                exists.</span>
<span class="sd">            area: The area of the water course to calculate.</span>
<span class="sd">            water_course: The water course to calculate.</span>
<span class="sd">            start_time: The (inclusive) start of the calculation interval.</span>
<span class="sd">            end_time: The (exclusive) end of the calculation interval.</span>
<span class="sd">            resolution: The resolution of the simulation. The default resolution</span>
<span class="sd">                of the inflow calculation case is used if this is left as `None`.</span>
<span class="sd">                Officially supported resolutions are 5, 10, 15, and 60 minutes.</span>
<span class="sd">            return_datasets: Generate and return HydSim datasets that can be used</span>
<span class="sd">                by Volue to diagnose issues with inflow calculations. For performance</span>
<span class="sd">                reasons this should be false when not trying to diagnose an issue.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An iterator of `None`. In future versions this iterator will yield</span>
<span class="sd">            log messages, datasets, and potentially more. The calculation is</span>
<span class="sd">            done when the iterator is exhausted.</span>

<span class="sd">            Exhausting the iterator without an exception does not guarantee</span>
<span class="sd">            that the calculation completed successfully. To determine that</span>
<span class="sd">            you must analyze the calculation&#39;s result time series and the</span>
<span class="sd">            log messages from the server.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError</span>
<span class="sd">            grpc.RpcError</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="Session.get_mc_file"><a class="viewcode-back" href="../../../hydsim.html#volue.mesh._base_session.Session.get_mc_file">[docs]</a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_mc_file</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">case</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Iterator</span><span class="p">[</span><span class="kc">None</span><span class="p">],</span> <span class="n">typing</span><span class="o">.</span><span class="n">AsyncIterator</span><span class="p">[</span><span class="kc">None</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate Marginal Cost input using HydSim on the Mesh server.</span>

<span class="sd">        Args:</span>
<span class="sd">            model: The name of the Mesh model in which the simulation case exists.</span>
<span class="sd">            case: The names of the case group and simulation case in the form</span>
<span class="sd">                &#39;CaseGroup/CaseName&#39;.</span>
<span class="sd">            start_time: The (inclusive) start of the simulation interval.</span>
<span class="sd">            end_time: The (exclusive) end of the simulation interval.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An iterator of `LogMessage`s followed by a single `str`. The final</span>
<span class="sd">            string is the Marginal Cost input.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError</span>
<span class="sd">            grpc.RpcError</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

    <span class="k">def</span> <span class="nf">_get_xy_sets_impl</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">],</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">],</span>
        <span class="n">versions_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">GetXySetsResponse</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generator implementation of get_xy_sets.</span>

<span class="sd">        Yields the protobuf request, receives the protobuf response, and yields</span>
<span class="sd">        the final result.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">start_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">end_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;start_time and end_time must both be None or both have a value&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">start_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">end_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="n">_to_proto_utcinterval</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">GetXySetsRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">attribute</span><span class="o">=</span><span class="n">_to_proto_attribute_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
            <span class="n">versions_only</span><span class="o">=</span><span class="n">versions_only</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">request</span>

        <span class="k">def</span> <span class="nf">get_valid_from_time</span><span class="p">(</span><span class="n">proto</span><span class="p">:</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">XySet</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">proto</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s2">&quot;valid_from_time&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">proto</span><span class="o">.</span><span class="n">valid_from_time</span><span class="o">.</span><span class="n">ToDatetime</span><span class="p">(</span><span class="n">dateutil</span><span class="o">.</span><span class="n">tz</span><span class="o">.</span><span class="n">UTC</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="k">yield</span> <span class="p">[</span>
            <span class="n">XySet</span><span class="p">(</span>
                <span class="n">get_valid_from_time</span><span class="p">(</span><span class="n">proto_xy_set</span><span class="p">),</span>
                <span class="p">[</span>
                    <span class="n">XyCurve</span><span class="p">(</span>
                        <span class="n">proto_curve</span><span class="o">.</span><span class="n">reference_value</span><span class="p">,</span>
                        <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">proto_curve</span><span class="o">.</span><span class="n">x_values</span><span class="p">,</span> <span class="n">proto_curve</span><span class="o">.</span><span class="n">y_values</span><span class="p">)),</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">proto_curve</span> <span class="ow">in</span> <span class="n">proto_xy_set</span><span class="o">.</span><span class="n">xy_curves</span>
                <span class="p">],</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">proto_xy_set</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">xy_sets</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">_prepare_update_xy_sets_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">],</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">],</span>
        <span class="n">new_xy_sets</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">XySet</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateXySetsRequest</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">start_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">end_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;start_time and end_time must both be None or both have a value&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">start_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">end_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">interval</span> <span class="o">=</span> <span class="n">_to_proto_utcinterval</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">to_proto_xy_curve</span><span class="p">(</span><span class="n">curve</span><span class="p">:</span> <span class="n">XyCurve</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">XyCurve</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">XyCurve</span><span class="p">(</span>
                <span class="n">reference_value</span><span class="o">=</span><span class="n">curve</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
                <span class="n">x_values</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">curve</span><span class="o">.</span><span class="n">xy</span><span class="p">],</span>
                <span class="n">y_values</span><span class="o">=</span><span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">curve</span><span class="o">.</span><span class="n">xy</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="k">def</span> <span class="nf">to_proto_xy_set</span><span class="p">(</span><span class="n">xy_set</span><span class="p">:</span> <span class="n">XySet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">XySet</span><span class="p">:</span>
            <span class="n">valid_from_time</span> <span class="o">=</span> <span class="p">(</span>
                <span class="kc">None</span>
                <span class="k">if</span> <span class="n">xy_set</span><span class="o">.</span><span class="n">valid_from_time</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="k">else</span> <span class="n">_datetime_to_timestamp_pb2</span><span class="p">(</span><span class="n">xy_set</span><span class="o">.</span><span class="n">valid_from_time</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">xy_curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_proto_xy_curve</span><span class="p">(</span><span class="n">curve</span><span class="p">)</span> <span class="k">for</span> <span class="n">curve</span> <span class="ow">in</span> <span class="n">xy_set</span><span class="o">.</span><span class="n">xy_curves</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">XySet</span><span class="p">(</span>
                <span class="n">valid_from_time</span><span class="o">=</span><span class="n">valid_from_time</span><span class="p">,</span> <span class="n">xy_curves</span><span class="o">=</span><span class="n">xy_curves</span>
            <span class="p">)</span>

        <span class="n">xy_sets</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_proto_xy_set</span><span class="p">(</span><span class="n">xy_set</span><span class="p">)</span> <span class="k">for</span> <span class="n">xy_set</span> <span class="ow">in</span> <span class="n">new_xy_sets</span><span class="p">]</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateXySetsRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">attribute</span><span class="o">=</span><span class="n">_to_proto_attribute_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
            <span class="n">xy_sets</span><span class="o">=</span><span class="n">xy_sets</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_read_timeseries_impl</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">time_series_pb2</span><span class="o">.</span><span class="n">ReadTimeseriesResponse</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generator implementation of read_timeseries.</span>

<span class="sd">        Yields the protobuf request, receives the protobuf response, and yields</span>
<span class="sd">        the final result.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">time_series_pb2</span><span class="o">.</span><span class="n">ReadTimeseriesRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">timeseries_id</span><span class="o">=</span><span class="n">_to_proto_read_timeseries_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">interval</span><span class="o">=</span><span class="n">_to_proto_utcinterval</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">request</span>

        <span class="n">timeseries</span> <span class="o">=</span> <span class="n">_read_proto_reply</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;invalid result from &#39;read_timeseries_points&#39;, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;expected 1 time series, but got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">yield</span> <span class="n">timeseries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_list_models_impl</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">ListModelsResponse</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generator implementation of list_models.</span>

<span class="sd">        Yields the protobuf request, receives the protobuf response, and yields</span>
<span class="sd">        the final result.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">ListModelsRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">request</span>

        <span class="k">yield</span> <span class="p">[</span>
            <span class="n">Object</span><span class="o">.</span><span class="n">_from_proto_object</span><span class="p">(</span><span class="n">proto_object</span><span class="p">)</span> <span class="k">for</span> <span class="n">proto_object</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">models</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">_prepare_get_object_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Object</span><span class="p">],</span>
        <span class="n">full_attribute_info</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">attributes_filter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AttributesFilter</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">GetObjectRequest</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a gRPC `GetObjectRequest`&quot;&quot;&quot;</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">GetObjectRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">object_id</span><span class="o">=</span><span class="n">_to_proto_object_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">attributes_masks</span><span class="o">=</span><span class="n">_to_proto_attribute_masks</span><span class="p">(</span><span class="n">attributes_filter</span><span class="p">),</span>
            <span class="n">attribute_field_mask</span><span class="o">=</span><span class="n">_to_proto_attribute_field_mask</span><span class="p">(</span>
                <span class="n">full_attribute_info</span><span class="p">,</span> <span class="n">attributes_filter</span>
            <span class="p">),</span>
            <span class="n">object_field_mask</span><span class="o">=</span><span class="n">_object_to_proto_field_mask</span><span class="p">(</span><span class="n">attributes_filter</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_prepare_search_for_objects_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Object</span><span class="p">],</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">full_attribute_info</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">attributes_filter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AttributesFilter</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">SearchObjectsRequest</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a gRPC `SearchObjectsRequest`&quot;&quot;&quot;</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">SearchObjectsRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">start_object_id</span><span class="o">=</span><span class="n">_to_proto_object_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">attributes_masks</span><span class="o">=</span><span class="n">_to_proto_attribute_masks</span><span class="p">(</span><span class="n">attributes_filter</span><span class="p">),</span>
            <span class="n">attribute_field_mask</span><span class="o">=</span><span class="n">_to_proto_attribute_field_mask</span><span class="p">(</span>
                <span class="n">full_attribute_info</span><span class="p">,</span> <span class="n">attributes_filter</span>
            <span class="p">),</span>
            <span class="n">object_field_mask</span><span class="o">=</span><span class="n">_object_to_proto_field_mask</span><span class="p">(</span><span class="n">attributes_filter</span><span class="p">),</span>
            <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_prepare_create_object_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">CreateObjectRequest</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a gRPC `CreateObjectRequest`&quot;&quot;&quot;</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">CreateObjectRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">owner_id</span><span class="o">=</span><span class="n">_to_proto_attribute_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_prepare_update_object_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Object</span><span class="p">],</span>
        <span class="n">new_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">new_owner_attribute</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">]],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateObjectRequest</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a gRPC `UpdateObjectRequest`&quot;&quot;&quot;</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateObjectRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">object_id</span><span class="o">=</span><span class="n">_to_proto_object_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">fields_to_update</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># providing new owner is optional</span>
        <span class="k">if</span> <span class="n">new_owner_attribute</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">new_owner_mesh_id</span> <span class="o">=</span> <span class="n">_to_proto_attribute_mesh_id</span><span class="p">(</span><span class="n">new_owner_attribute</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># Wrap the error so that the user can distinguish what</span>
                <span class="c1"># MeshId is wrong: target or new_owner_attribute.</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;invalid new owner attribute&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

            <span class="n">request</span><span class="o">.</span><span class="n">new_owner_id</span><span class="o">.</span><span class="n">CopyFrom</span><span class="p">(</span><span class="n">new_owner_mesh_id</span><span class="p">)</span>
            <span class="n">fields_to_update</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;new_owner_id&quot;</span><span class="p">)</span>

        <span class="c1"># providing new name is optional</span>
        <span class="k">if</span> <span class="n">new_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">request</span><span class="o">.</span><span class="n">new_name</span> <span class="o">=</span> <span class="n">new_name</span>
            <span class="n">fields_to_update</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;new_name&quot;</span><span class="p">)</span>

        <span class="n">request</span><span class="o">.</span><span class="n">field_mask</span><span class="o">.</span><span class="n">CopyFrom</span><span class="p">(</span>
            <span class="n">protobuf</span><span class="o">.</span><span class="n">field_mask_pb2</span><span class="o">.</span><span class="n">FieldMask</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">fields_to_update</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_prepare_delete_object_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Object</span><span class="p">],</span> <span class="n">recursive_delete</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">DeleteObjectRequest</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a gRPC `DeleteObjectRequest`&quot;&quot;&quot;</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">DeleteObjectRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">object_id</span><span class="o">=</span><span class="n">_to_proto_object_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">recursive_delete</span><span class="o">=</span><span class="n">recursive_delete</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_prepare_get_attribute_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span> <span class="n">full_attribute_info</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">GetAttributeRequest</span><span class="p">:</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">GetAttributeRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">attribute_id</span><span class="o">=</span><span class="n">_to_proto_attribute_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">field_mask</span><span class="o">=</span><span class="n">_to_proto_attribute_field_mask</span><span class="p">(</span><span class="n">full_attribute_info</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_prepare_search_attributes_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Object</span><span class="p">],</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">full_attribute_info</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">SearchAttributesRequest</span><span class="p">:</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">SearchAttributesRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">start_object_id</span><span class="o">=</span><span class="n">_to_proto_object_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
            <span class="n">field_mask</span><span class="o">=</span><span class="n">_to_proto_attribute_field_mask</span><span class="p">(</span><span class="n">full_attribute_info</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_prepare_update_simple_attribute_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">value</span><span class="p">:</span> <span class="n">SIMPLE_TYPE_OR_COLLECTION</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateSimpleAttributeRequest</span><span class="p">:</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateSimpleAttributeRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">attribute_id</span><span class="o">=</span><span class="n">_to_proto_attribute_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="p">(</span>
            <span class="n">new_singular_value</span><span class="p">,</span>
            <span class="n">new_collection_values</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_update_attribute_request_values</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">new_singular_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">request</span><span class="o">.</span><span class="n">new_singular_value</span><span class="o">.</span><span class="n">CopyFrom</span><span class="p">(</span><span class="n">new_singular_value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">new_collection_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_collection_values</span><span class="p">:</span>
                <span class="n">request</span><span class="o">.</span><span class="n">new_collection_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_prepare_update_timeseries_attribute_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">new_local_expression</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">new_timeseries_resource_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateTimeseriesAttributeRequest</span><span class="p">:</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateTimeseriesAttributeRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">attribute_id</span><span class="o">=</span><span class="n">_to_proto_attribute_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">fields_to_update</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">new_local_expression</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fields_to_update</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;new_local_expression&quot;</span><span class="p">)</span>
            <span class="n">request</span><span class="o">.</span><span class="n">new_local_expression</span> <span class="o">=</span> <span class="n">new_local_expression</span>

        <span class="k">if</span> <span class="n">new_timeseries_resource_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fields_to_update</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;new_timeseries_resource_key&quot;</span><span class="p">)</span>
            <span class="n">request</span><span class="o">.</span><span class="n">new_timeseries_resource_key</span> <span class="o">=</span> <span class="n">new_timeseries_resource_key</span>

        <span class="n">request</span><span class="o">.</span><span class="n">field_mask</span><span class="o">.</span><span class="n">CopyFrom</span><span class="p">(</span>
            <span class="n">protobuf</span><span class="o">.</span><span class="n">field_mask_pb2</span><span class="o">.</span><span class="n">FieldMask</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">fields_to_update</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_prepare_update_link_relation_attribute_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">new_target_object_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">],</span>
        <span class="n">append</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateLinkRelationAttributeRequest</span><span class="p">:</span>
        <span class="n">proto_target_object_ids</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">_to_proto_guid</span><span class="p">(</span><span class="n">target_object_id</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">target_object_id</span> <span class="ow">in</span> <span class="n">new_target_object_ids</span>
        <span class="p">]</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateLinkRelationAttributeRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">attribute</span><span class="o">=</span><span class="n">_to_proto_attribute_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">append</span><span class="o">=</span><span class="n">append</span><span class="p">,</span>
            <span class="n">target_object_ids</span><span class="o">=</span><span class="n">proto_target_object_ids</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_prepare_versioned_link_relation_attribute_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">entries</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">LinkRelationVersion</span><span class="p">]],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateVersionedLinkRelationAttributeRequest</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">start_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">end_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;start_time and end_time must both be None or both have a value&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">start_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">end_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto_interval</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">proto_interval</span> <span class="o">=</span> <span class="n">_to_proto_utcinterval</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">to_proto_link_relation_version</span><span class="p">(</span>
            <span class="n">version</span><span class="p">:</span> <span class="n">LinkRelationVersion</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">LinkRelationVersion</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">LinkRelationVersion</span><span class="p">(</span>
                <span class="n">target_object_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="n">version</span><span class="o">.</span><span class="n">target_object_id</span><span class="p">),</span>
                <span class="n">valid_from_time</span><span class="o">=</span><span class="p">(</span>
                    <span class="kc">None</span>
                    <span class="k">if</span> <span class="n">version</span><span class="o">.</span><span class="n">valid_from_time</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="n">_datetime_to_timestamp_pb2</span><span class="p">(</span><span class="n">version</span><span class="o">.</span><span class="n">valid_from_time</span><span class="p">)</span>
                <span class="p">),</span>
            <span class="p">)</span>

        <span class="k">def</span> <span class="nf">to_proto_link_relation_entry</span><span class="p">(</span>
            <span class="n">versions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">LinkRelationVersion</span><span class="p">],</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">VersionedLinkRelationAttributeValue</span><span class="p">:</span>

            <span class="k">return</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">VersionedLinkRelationAttributeValue</span><span class="p">(</span>
                <span class="n">versions</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">to_proto_link_relation_version</span><span class="p">(</span><span class="n">version</span><span class="p">)</span> <span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="n">versions</span>
                <span class="p">]</span>
            <span class="p">)</span>

        <span class="n">proto_entries</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_proto_link_relation_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">]</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateVersionedLinkRelationAttributeRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">attribute</span><span class="o">=</span><span class="n">_to_proto_attribute_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">interval</span><span class="o">=</span><span class="n">proto_interval</span><span class="p">,</span>
            <span class="n">entries</span><span class="o">=</span><span class="n">proto_entries</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_to_proto_singular_attribute_value</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">SIMPLE_TYPE</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">AttributeValue</span><span class="p">:</span>
        <span class="n">att_value</span> <span class="o">=</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">AttributeValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">att_value</span><span class="o">.</span><span class="n">int_value</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">float</span><span class="p">:</span>
            <span class="n">att_value</span><span class="o">.</span><span class="n">double_value</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="n">att_value</span><span class="o">.</span><span class="n">boolean_value</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">att_value</span><span class="o">.</span><span class="n">string_value</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="n">datetime</span><span class="p">:</span>
            <span class="n">att_value</span><span class="o">.</span><span class="n">utc_time_value</span><span class="o">.</span><span class="n">CopyFrom</span><span class="p">(</span><span class="n">_datetime_to_timestamp_pb2</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Not supported value type. Supported simple types are: boolean, float, int, str, datetime.&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">att_value</span>

    <span class="k">def</span> <span class="nf">_to_update_attribute_request_values</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">SIMPLE_TYPE_OR_COLLECTION</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span>
        <span class="n">Optional</span><span class="p">[</span><span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">AttributeValue</span><span class="p">],</span>
        <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">AttributeValue</span><span class="p">]],</span>
    <span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert value supplied by the user to singular value/collection values</span>
<span class="sd">        expected by the protobuf request.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_singular_value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">new_collection_values</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="n">new_collection_values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">att_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_proto_singular_attribute_value</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">new_collection_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">att_value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_singular_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_proto_singular_attribute_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">new_singular_value</span><span class="p">,</span> <span class="n">new_collection_values</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare_update_timeseries_resource_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">timeseries_key</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">new_curve_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Timeseries</span><span class="o">.</span><span class="n">Curve</span><span class="p">],</span>
        <span class="n">new_unit_of_measurement_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">resources_pb2</span><span class="o">.</span><span class="n">Guid</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">time_series_pb2</span><span class="o">.</span><span class="n">UpdateTimeseriesResourceRequest</span><span class="p">:</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">time_series_pb2</span><span class="o">.</span><span class="n">UpdateTimeseriesResourceRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">timeseries_resource_key</span><span class="o">=</span><span class="n">timeseries_key</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">fields_to_update</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">new_curve_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fields_to_update</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;new_curve_type&quot;</span><span class="p">)</span>
            <span class="n">request</span><span class="o">.</span><span class="n">new_curve_type</span><span class="o">.</span><span class="n">CopyFrom</span><span class="p">(</span><span class="n">_to_proto_curve_type</span><span class="p">(</span><span class="n">new_curve_type</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">new_unit_of_measurement_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fields_to_update</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;new_unit_of_measurement_id&quot;</span><span class="p">)</span>
            <span class="n">request</span><span class="o">.</span><span class="n">new_unit_of_measurement_id</span><span class="o">.</span><span class="n">CopyFrom</span><span class="p">(</span><span class="n">new_unit_of_measurement_id</span><span class="p">)</span>

        <span class="n">request</span><span class="o">.</span><span class="n">field_mask</span><span class="o">.</span><span class="n">CopyFrom</span><span class="p">(</span>
            <span class="n">protobuf</span><span class="o">.</span><span class="n">field_mask_pb2</span><span class="o">.</span><span class="n">FieldMask</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="n">fields_to_update</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_get_rating_curve_versions_impl</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">versions_only</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Generator</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">,</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">GetRatingCurveVersionsResponse</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generator implementation of get_rating_curve_versions.</span>

<span class="sd">        Yields the protobuf request, receives the protobuf response, and yields</span>
<span class="sd">        the final result.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">start_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">end_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;start_time and end_time must both have a value&quot;</span><span class="p">)</span>

        <span class="n">interval</span> <span class="o">=</span> <span class="n">_to_proto_utcinterval</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">GetRatingCurveVersionsRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">attribute</span><span class="o">=</span><span class="n">_to_proto_attribute_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span>
            <span class="n">versions_only</span><span class="o">=</span><span class="n">versions_only</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">response</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">request</span>

        <span class="c1"># name of the field in proto file is a Python keyword</span>
        <span class="c1"># need to use `getattr` to get its value, see:</span>
        <span class="c1"># https://developers.google.com/protocol-buffers/docs/reference/python-generated#keyword-conflicts</span>
        <span class="k">yield</span> <span class="p">[</span>
            <span class="n">RatingCurveVersion</span><span class="p">(</span>
                <span class="n">x_range_from</span><span class="o">=</span><span class="n">proto_version</span><span class="o">.</span><span class="n">x_range_from</span><span class="p">,</span>
                <span class="n">valid_from_time</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">proto_version</span><span class="p">,</span> <span class="s2">&quot;from&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ToDatetime</span><span class="p">(</span>
                    <span class="n">dateutil</span><span class="o">.</span><span class="n">tz</span><span class="o">.</span><span class="n">UTC</span>
                <span class="p">),</span>
                <span class="n">x_value_segments</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">RatingCurveSegment</span><span class="p">(</span>
                        <span class="n">proto_segment</span><span class="o">.</span><span class="n">x_range_until</span><span class="p">,</span>
                        <span class="n">proto_segment</span><span class="o">.</span><span class="n">factor_a</span><span class="p">,</span>
                        <span class="n">proto_segment</span><span class="o">.</span><span class="n">factor_b</span><span class="p">,</span>
                        <span class="n">proto_segment</span><span class="o">.</span><span class="n">factor_c</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">proto_segment</span> <span class="ow">in</span> <span class="n">proto_version</span><span class="o">.</span><span class="n">x_value_segments</span>
                <span class="p">],</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">proto_version</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">versions</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">_prepare_update_rating_curve_versions_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">AttributeBase</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">new_versions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">RatingCurveVersion</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateRatingCurveVersionsRequest</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">start_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">end_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;start_time and end_time must both have a value&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">to_proto_rating_curve_segment</span><span class="p">(</span>
            <span class="n">segment</span><span class="p">:</span> <span class="n">RatingCurveSegment</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">RatingCurveSegment</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">RatingCurveSegment</span><span class="p">(</span>
                <span class="n">x_range_until</span><span class="o">=</span><span class="n">segment</span><span class="o">.</span><span class="n">x_range_until</span><span class="p">,</span>
                <span class="n">factor_a</span><span class="o">=</span><span class="n">segment</span><span class="o">.</span><span class="n">factor_a</span><span class="p">,</span>
                <span class="n">factor_b</span><span class="o">=</span><span class="n">segment</span><span class="o">.</span><span class="n">factor_b</span><span class="p">,</span>
                <span class="n">factor_c</span><span class="o">=</span><span class="n">segment</span><span class="o">.</span><span class="n">factor_c</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">def</span> <span class="nf">to_proto_rating_curve_version</span><span class="p">(</span>
            <span class="n">version</span><span class="p">:</span> <span class="n">RatingCurveVersion</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">RatingCurveVersion</span><span class="p">:</span>
            <span class="n">proto_segments</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">to_proto_rating_curve_segment</span><span class="p">(</span><span class="n">segment</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">segment</span> <span class="ow">in</span> <span class="n">version</span><span class="o">.</span><span class="n">x_value_segments</span>
            <span class="p">]</span>

            <span class="n">proto_version</span> <span class="o">=</span> <span class="n">model_resources_pb2</span><span class="o">.</span><span class="n">RatingCurveVersion</span><span class="p">(</span>
                <span class="n">x_range_from</span><span class="o">=</span><span class="n">version</span><span class="o">.</span><span class="n">x_range_from</span><span class="p">,</span> <span class="n">x_value_segments</span><span class="o">=</span><span class="n">proto_segments</span>
            <span class="p">)</span>

            <span class="c1"># name of the field in proto file is a Python keyword</span>
            <span class="c1"># need to use `setattr`, but because it is not a simple type</span>
            <span class="c1"># first we need to call `getattr` and then set its value via</span>
            <span class="c1"># CopyFrom or FromDatetime, see:</span>
            <span class="c1"># https://developers.google.com/protocol-buffers/docs/reference/python-generated#keyword-conflicts</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">proto_version</span><span class="p">,</span> <span class="s2">&quot;from&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">FromDatetime</span><span class="p">(</span><span class="n">version</span><span class="o">.</span><span class="n">valid_from_time</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">proto_version</span>

        <span class="n">proto_versions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">to_proto_rating_curve_version</span><span class="p">(</span><span class="n">version</span><span class="p">)</span> <span class="k">for</span> <span class="n">version</span> <span class="ow">in</span> <span class="n">new_versions</span>
        <span class="p">]</span>

        <span class="n">request</span> <span class="o">=</span> <span class="n">model_pb2</span><span class="o">.</span><span class="n">UpdateRatingCurveVersionsRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">attribute</span><span class="o">=</span><span class="n">_to_proto_attribute_mesh_id</span><span class="p">(</span><span class="n">target</span><span class="p">),</span>
            <span class="n">interval</span><span class="o">=</span><span class="n">_to_proto_utcinterval</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">),</span>
            <span class="n">versions</span><span class="o">=</span><span class="n">proto_versions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">request</span>

    <span class="k">def</span> <span class="nf">_prepare_run_simulation_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">case</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">resolution</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
        <span class="n">scenario</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">return_datasets</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hydsim_pb2</span><span class="o">.</span><span class="n">RunHydroSimulationRequest</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">start_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">end_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;start_time and end_time must both have a value&quot;</span><span class="p">)</span>

        <span class="n">case_group</span><span class="p">,</span> <span class="n">case_name</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">simulation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Model/</span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">case_group</span><span class="si">}</span><span class="s2">.has_OptimisationCases/</span><span class="si">{</span><span class="n">case_name</span><span class="si">}</span><span class="s2">.has_OptimisationParameters/Optimal.has_HydroSimulation/HydroSimulation&quot;</span>

        <span class="n">proto_resolution</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto_resolution</span> <span class="o">=</span> <span class="n">protobuf</span><span class="o">.</span><span class="n">duration_pb2</span><span class="o">.</span><span class="n">Duration</span><span class="p">()</span>
            <span class="n">proto_resolution</span><span class="o">.</span><span class="n">FromTimedelta</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">hydsim_pb2</span><span class="o">.</span><span class="n">RunHydroSimulationRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">simulation</span><span class="o">=</span><span class="n">_to_proto_object_mesh_id</span><span class="p">(</span><span class="n">simulation</span><span class="p">),</span>
            <span class="n">interval</span><span class="o">=</span><span class="n">_to_proto_utcinterval</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">),</span>
            <span class="n">scenario</span><span class="o">=</span><span class="n">scenario</span><span class="p">,</span>
            <span class="n">resolution</span><span class="o">=</span><span class="n">proto_resolution</span><span class="p">,</span>
            <span class="n">return_datasets</span><span class="o">=</span><span class="n">return_datasets</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare_run_inflow_calculation_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">targets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Object</span><span class="p">],</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">resolution</span><span class="p">:</span> <span class="n">timedelta</span><span class="p">,</span>
        <span class="n">return_datasets</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">hydsim_pb2</span><span class="o">.</span><span class="n">RunInflowCalculationRequest</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">start_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">end_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;start_time and end_time must both have a value&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;expected one water course, found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">proto_resolution</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proto_resolution</span> <span class="o">=</span> <span class="n">protobuf</span><span class="o">.</span><span class="n">duration_pb2</span><span class="o">.</span><span class="n">Duration</span><span class="p">()</span>
            <span class="n">proto_resolution</span><span class="o">.</span><span class="n">FromTimedelta</span><span class="p">(</span><span class="n">resolution</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">hydsim_pb2</span><span class="o">.</span><span class="n">RunInflowCalculationRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">watercourse</span><span class="o">=</span><span class="n">_to_proto_object_mesh_id</span><span class="p">(</span><span class="n">targets</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">id</span><span class="p">),</span>
            <span class="n">interval</span><span class="o">=</span><span class="n">_to_proto_utcinterval</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">),</span>
            <span class="n">resolution</span><span class="o">=</span><span class="n">proto_resolution</span><span class="p">,</span>
            <span class="n">return_datasets</span><span class="o">=</span><span class="n">return_datasets</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare_get_mc_file_request</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">case</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">start_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">end_time</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">if</span> <span class="n">start_time</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">end_time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;start_time and end_time must both have a value&quot;</span><span class="p">)</span>

        <span class="n">case_group</span><span class="p">,</span> <span class="n">case_name</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">optimisation_case</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Model/</span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">case_group</span><span class="si">}</span><span class="s2">.has_OptimisationCases/</span><span class="si">{</span><span class="n">case_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">hydsim_pb2</span><span class="o">.</span><span class="n">GetMcFileRequest</span><span class="p">(</span>
            <span class="n">session_id</span><span class="o">=</span><span class="n">_to_proto_guid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">),</span>
            <span class="n">optimisation_case</span><span class="o">=</span><span class="n">_to_proto_object_mesh_id</span><span class="p">(</span><span class="n">optimisation_case</span><span class="p">),</span>
            <span class="n">interval</span><span class="o">=</span><span class="n">_to_proto_utcinterval</span><span class="p">(</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_unit_of_measurement_id_by_name</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">unit_of_measurement</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">list_response</span><span class="p">:</span> <span class="n">model_definition_pb2</span><span class="o">.</span><span class="n">ListUnitsOfMeasurementResponse</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">resources_pb2</span><span class="o">.</span><span class="n">Guid</span><span class="p">:</span>
        <span class="n">new_unit_of_measurement_id</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">for</span> <span class="n">proto_unit</span> <span class="ow">in</span> <span class="n">list_response</span><span class="o">.</span><span class="n">units_of_measurement</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proto_unit</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">unit_of_measurement</span><span class="p">:</span>
                <span class="n">new_unit_of_measurement_id</span> <span class="o">=</span> <span class="n">proto_unit</span><span class="o">.</span><span class="n">id</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">new_unit_of_measurement_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid unit of measurement provided&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_unit_of_measurement_id</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2024, Volue AS.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>